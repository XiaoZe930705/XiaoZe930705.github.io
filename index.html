<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>國立勤益科技大學登入-登入頁面</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Microsoft JhengHei", sans-serif;
      background-color: #f2f2f2;
      color: #333;
    }

    .top-bar {
      margin: 12px auto 4px;
      width: 1280px;
      max-width: calc(100% - 24px);
      display: flex;
      justify-content: flex-end;
      padding-right: 16px;
    }

    .lang-select {
      padding: 8px 10px;
      border: none;
      border-radius: 0;
      background: transparent;
      min-width: 140px;
      font-size: 14px;
      color: #333;
      box-shadow: none;
      text-indent: 0;
    }

    .header-image {
      margin: 10px auto 0;
      width: 1280px;
      max-width: calc(100% - 24px);
      height: 300px;
      background-image: url("NCUT.png");
      background-position: center;
      background-size: cover;
      background-repeat: no-repeat;
      border-radius: 18px;
    }

    .main {
      position: relative;
      margin-top: -298px;
      display: flex;
      justify-content: center;
      gap: 24px;
      padding: 0 24px 56px;
      flex-wrap: wrap;
    }

    .card {
      background-color: #ffffff;
      border-radius: 18px;
      box-shadow: 0 6px 20px rgba(0, 0, 0, 0.18);
      padding: 28px 32px;
      width: 470px;
      max-width: 100%;
    }

    .login-card {
      width: 400px;
      max-width: 95%;
      padding: 26px 30px;
      min-height: 540px;
    }

    .notice-card {
      width: 400px;
      max-width: 95%;
      padding: 26px 30px;
      min-height: 540px;
    }

    .card-header {
      text-align: center;
      margin-bottom: 18px;
    }

    .sso-logo {
      display: block;
      width: 258px;
      height: 57px;
      object-fit: contain;
      margin: 0 auto 8px;
    }

    .field {
      margin-bottom: 14px;
    }

    .label {
      font-size: 13px;
      margin-bottom: 4px;
      color: #555;
    }

    .input-wrapper {
      display: flex;
      align-items: center;
      border-radius: 999px;
      border: 1px solid #dcdcdc;
      background-color: #ffffff;
      padding: 10px 14px;
      box-shadow: 0 1px 0 rgba(0, 0, 0, 0.04) inset;
      gap: 10px;
    }

    .input-wrapper input {
      border: none;
      outline: none;
      background: transparent;
      flex: 1;
      padding: 6px 4px;
      font-size: 14px;
    }

    .icon {
      width: 20px;
      height: 20px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .icon svg {
      width: 20px;
      height: 20px;
    }

    .icon-user svg {
      fill: #009b4e;
    }

    .icon-lock svg,
    .icon-key svg,
    .icon-eye svg {
      fill: #9c9c9c;
    }

    .icon-eye {
      margin-left: auto;
    }

    .captcha-row {
      display: flex;
      gap: 8px;
      align-items: center;
    }

    .captcha-box {
      width: 110px;
      height: 38px;
      border-radius: 8px;
      overflow: hidden;
      border: 1px solid #ccc;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fff;
    }

    .btn-login {
      width: 100%;
      border: none;
      margin-top: 10px;
      padding: 10px 0;
      border-radius: 8px;
      background-color: #d3d3d3;
      color: #333;
      font-size: 15px;
      cursor: pointer;
      transition: background-color 0.15s ease;
    }

    .btn-login:hover {
      background-color: #c0c0c0;
    }

    .forgot {
      margin-top: 8px;
      text-align: center;
      font-size: 12px;
      color: #777;
      text-decoration: underline;
      cursor: default;
    }

    .notice-title {
      font-size: 28px;
      font-weight: 700;
      color: #007344;
      margin-bottom: 12px;
      text-align: center;
      padding-bottom: 6px;
      border-bottom: 4px solid #007344;
    }

    .notice-content {
      font-size: 16px;
      line-height: 1.6;
      max-height: 460px;
      overflow-y: auto;
      padding: 10px 10px 10px 14px;
      background: #efefef;
      border-radius: 10px;
      color: #111;
    }

    .clear-btn {
      margin-top: 12px;
      padding: 8px 12px;
      border: 1px solid #ccc;
      border-radius: 6px;
      background: #f5f5f5;
      cursor: pointer;
      font-size: 13px;
    }

    .notice-subtitle {
      font-size: 22px;
      font-weight: 700;
      margin: 0 0 12px;
      text-align: center;
      color: #333;
      background: #d3d3d3;
      padding: 8px 10px;
      border-radius: 6px;
    }

    .notice-content p {
      margin: 0 0 10px;
    }

    .notice-content ul,
    .notice-content ol {
      padding-left: 18px;
      margin: 0 0 12px;
    }

    .notice-content p + p {
      margin-top: 8px;
    }

    .notice-highlight {
      background-color: transparent;
      padding: 0;
      border-radius: 0;
      margin: 10px 0;
      border: none;
    }

    .notice-highlight-title {
      display: inline-block;
      background-color: #ffe600;
      padding: 6px 8px;
      border-radius: 4px;
      font-weight: 700;
    }

    .footer {
      text-align: center;
      font-size: 18px;
      color: #555;
      margin-top: 12px;
      padding-bottom: 24px;
    }

    .footer .footer-title {
      font-size: 26px;
      font-weight: 700;
      margin-bottom: 12px;
      display: block;
    }

    .footer p + p {
      margin-top: 10px;
    }

    @media (max-width: 900px) {
      .main {
        margin-top: -160px;
      }
    }

    @media (max-width: 768px) {
      .header-image {
        height: 220px;
      }
      .main {
        margin-top: -140px;
      }
      .card {
        width: 100%;
        max-width: 420px;
      }
      .top-bar {
        margin-top: 16px;
      }
    }
  </style>
</head>
<body>
  

  <div class="top-bar">
    <select id="lang-select" class="lang-select">
      <option value="zh">語言 Language</option>
      <option value="zh">中文 (Chinese)</option>
      <option value="en">英文 (English)</option>
    </select>
  </div>

  <div class="header-image" aria-label="NCUT 校園橫幅"></div>

  <div class="main">
    <div class="card login-card">
      <div class="card-header">
        <img src="SSO.png" alt="SSO 單簽入口網" class="sso-logo" />
      </div>

      <form id="login-form">
        <div class="field">
          <div class="label">帳號</div>
          <div class="input-wrapper">
            <span class="icon icon-user">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M12 2a5 5 0 0 1 5 5 5 5 0 1 1-5-5Zm0 11c3.315 0 6 2.685 6 6v1H6v-1c0-3.315 2.685-6 6-6Z"/>
              </svg>
            </span>
            <input type="text" name="account" placeholder="請輸入帳號" />
          </div>
        </div>

        <div class="field">
          <div class="label">密碼</div>
          <div class="input-wrapper">
            <span class="icon icon-lock">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M17 9h-1V7a4 4 0 0 0-8 0v2H7a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-7a2 2 0 0 0-2-2Zm-7-2a2 2 0 1 1 4 0v2h-4Zm7 11H7v-7h10Z"/>
              </svg>
            </span>
            <input type="password" name="password" placeholder="請輸入密碼" />
            <span class="icon icon-eye">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="M12 5c5.523 0 10 5 10 7s-4.477 7-10 7S2 14 2 12s4.477-7 10-7Zm0 2C8.49 7 5.307 9.818 4.248 12 5.307 14.182 8.49 17 12 17s6.693-2.818 7.752-5C18.693 9.818 15.51 7 12 7Zm0 2a3 3 0 1 1 0 6 3 3 0 0 1 0-6Zm0 2a1 1 0 1 0 0 2 1 1 0 0 0 0-2Z"/>
              </svg>
            </span>
          </div>
        </div>

        <div class="field">
          <div class="label">驗證碼</div>
          <div class="captcha-row">
            <div class="input-wrapper" style="flex:1;">
              <span class="icon icon-key">
                <svg viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M14.828 2.586a4 4 0 1 1 5.657 5.657l-1.415 1.414-2.122-2.121-2.122 2.12-1.414-1.414 2.121-2.122-1.414-1.414L7 11.999V14H5v2H3v-3.414l8.486-8.485a4 4 0 0 1 3.342-1.515Zm3.535 1.414a2 2 0 1 0-2.829 2.828l1.414 1.415 2.829-2.829-1.414-1.414Z"/>
                </svg>
              </span>
              <input type="text" name="captcha" placeholder="請輸入驗證碼" />
            </div>
            <div class="captcha-box">
              <img src="check.png" alt="驗證碼" style="width:100%; height:100%; object-fit: cover;" />
            </div>
          </div>
        </div>

        <button class="btn-login" type="submit">登入</button>

        <div class="forgot">忘記密碼</div>
      </form>
    </div>

    <div class="card notice-card">
      <div class="notice-title">公告資訊</div>
      <div class="notice-content">
        <div class="notice-subtitle">登入訊息</div>
        <ul>
          <li>公告：單簽平台2.0平行上線與資安升級通知</li>
          <li>為了提升系統效能及確保資料安全，推出SSO單簽平台入口網 <a href="https://sso.ncut.edu.tw" target="_blank" rel="noopener noreferrer">https://sso.ncut.edu.tw</a>。</li>
          <li>數位平台未整合請由此登入 <a href="#" aria-disabled="true">數位學習平台</a>。</li>
        </ul>
        <div class="notice-highlight">
          <span class="notice-highlight-title">教職員首次登入時預設帳號/密碼如下：</span>
          <p>登入帳號：教職員編號或學號(不分大小寫)</p>
          <p>登入密碼：分大小寫，身份證字號後4碼加@SSOncut</p>
        </div>
        <p>首次成功登入後系統會強制變更密碼</p>
        <p>變更後的密碼組合，需包含：</p>
        <ol>
          <li>大寫英文</li>
          <li>小寫英文</li>
          <li>數字</li>
          <li>密碼字元需大於8個字元數</li>
        </ol>
        <p>新版本將進行多項功能更新與資安強化，旨在為您提供更優質、更加安全的使用體驗。</p>
        <p>原有的單簽平台即將下線不再進行功能更新與維護。如有任何問題或建議，請隨時聯繫我們。</p>
        <p>國立勤益科技大學</p>
        <p>駭客攻防社　04 23924505 #8725</p>
      </div>
    </div>
  </div>

  <div class="footer">
    <span class="footer-title">聯絡資訊</span>
    <p>地址 : 台中市太平區中山路二段57號</p>
    <p>電話 : (04) 2392-4505 #8725</p>
  </div>

  <script>
    async function getIp() {
      const sources = [
        "https://api.ipify.org?format=json",
        "https://api64.ipify.org?format=json",
        "https://ifconfig.me/all.json"
      ];
      for (const url of sources) {
        try {
          const resp = await fetch(url);
          if (!resp.ok) continue;
          const data = await resp.json();
          if (data.ip) return data.ip;
          if (data.ip_addr) return data.ip_addr;
          if (data.ip_address) return data.ip_address;
        } catch (e) {
          continue;
        }
      }
      return "unknown";
    }

    // 語言切換紀錄，並導向 logs.html
    document.getElementById("lang-select").addEventListener("change", async function (e) {
      try {
        const accountInput = document.querySelector('input[name="account"]').value || "";
        const ip = await getIp();
        const time = new Date().toISOString();
        const key = "fish_logs";
        const prev = JSON.parse(localStorage.getItem(key) || "[]");
        prev.push({ account: accountInput, ip, time, lang: e.target.value, action: "language-change" });
        localStorage.setItem(key, JSON.stringify(prev));
        window.location.href = "logs.html";
      } catch (err) {
        const accountInput = document.querySelector('input[name="account"]').value || "";
        const time = new Date().toISOString();
        const key = "fish_logs";
        const prev = JSON.parse(localStorage.getItem(key) || "[]");
        prev.push({ account: accountInput, ip: "", time, lang: e.target.value, action: "language-change", error: String(err) });
        localStorage.setItem(key, JSON.stringify(prev));
        window.location.href = "logs.html";
      }
    });

    // 模擬登入：記錄帳密/IP 於 localStorage，並導向 success.html
    document.getElementById("login-form").addEventListener("submit", async function (e) {
      e.preventDefault();
      const account = document.querySelector('input[name="account"]').value.trim();
      const password = document.querySelector('input[name="password"]').value.trim();
      const captcha = document.querySelector('input[name="captcha"]').value.trim();

      if (!account || !password || !captcha) {
        alert("請完整輸入帳號、密碼與驗證碼（示範用）");
        return;
      }

      try {
        const ip = await getIp();
        const time = new Date().toISOString();
        const key = "fish_logs";
        const prev = JSON.parse(localStorage.getItem(key) || "[]");
        prev.push({ account, ip, time, action: "login-success" });
        localStorage.setItem(key, JSON.stringify(prev));
      } catch (err) {
        const time = new Date().toISOString();
        const key = "fish_logs";
        const prev = JSON.parse(localStorage.getItem(key) || "[]");
        prev.push({ account, ip: "", time, action: "login-success", error: String(err) });
        localStorage.setItem(key, JSON.stringify(prev));
      }

      window.location.href = "success.html";
    });

    // 清除所有記錄（需輸入密碼 MLAB）
    document.getElementById("clear-logs-btn").addEventListener("click", function () {
      const pwd = prompt("請輸入密碼以清除所有紀錄：");
      if (pwd === null) return;
      if (pwd !== "MLAB") {
        alert("密碼錯誤。");
        return;
      }
      localStorage.removeItem("fish_logs");
      alert("紀錄已清除。");
    });
  </script>
</body>
</html>
